<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
  <title>AngularJS Smart-Table select all rows directive</title>
  <meta name="description" content="So I’ve been recently working on an app that required the ability for users to select all rows in a table, as well as selecting rows manually. I then realise...">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link href="//www.google-analytics.com" rel="dns-prefetch">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://razvanbalosin.com/angularjs-smart-table-select-all-rows-directive">
  <link rel="alternate" type="application/rss+xml" title="Razvan Balosin" href="http://razvanbalosin.com/feed.xml" />
</head>


  <body>

    <div class="site-header">

    <div class="card">
      <div class="top-bar"></div>
      <a class="site-avatar" href="/">
        <img src="/assets/img/avatar.png"/>
      </a>
      <a class="site-title" href="/">Razvan Balosin</a>
      <span class="site-description">Front End Engineer <br/>JavaScript, AngularJS</span>
    </div>

    <nav class="site-nav">
      <ul>
        <li>
          <a href="/">
            <i class="fa fa-home"></i>
            Home
          </a>
        </li>
        <li>
          <a href="//github.com/razvanbalosin" target="_blank">
            <i class="fa fa-github"></i>
            GitHub
          </a>
        </li>
      </ul>
    </nav>

    <div class="work">
      <span class="desc">currently working at</span>
      <a class="work-link" href="//wordtail.com" title="WordTail" target="_blank">
        <img class="work-icon" src="/assets/img/work.png" alt="WordTail">
        <div class="info">
          <div class="title">WordTail</div>
          <span class="subtitle">Keyword Position Monitoring</span>
        </div>
      </a>
    </div>

</div>


    <div class="page-content">
      <div class="wrapper">
            <article class="post clear">
      <h1 class="post__title">
        AngularJS Smart-Table select all rows directive
      </h1>
      <div class="post__meta">
<!--         
        <a class="post__meta-edit" href="//github.com/razvanbalosin/razvanbalosin.github.io/blob/master/_posts/2015-08-02-angularjs-smart-table-select-all-rows-directive.md">
          <i class="fa fa-github"></i>
          Edit this page on GitHub
        </a>
         -->
        
        <span class="post__meta-edit">
          <i class="fa fa-calendar"></i>
          August 02, 2015
        </span>
        
      </div> 

      <p>So I’ve been recently working on an app that required the ability for users to select all rows in a table, as well as selecting rows manually. I then realised that such a function had not existed yet for Smart Table Module, so I thought I’d share this with you guys.
You’ll also be able the get the data from the selected rows into a <code>$scope</code>, which for some reason, is not yet implemented in Smart-Table.</p>

<blockquote>
  <p><a href="//google.com">Smart Table</a> is a table module for AngularJS. It allows you to quickly compose your table in a declarative way including sorting, filtering, row selection and pagination. It’s also lightweight (around 3kb minified) and has no other dependencies than Angular itself.</p>
</blockquote>

<p>Firstly, let’s start with the directives. There is one for row slection, which creates the checkbox for every row and assigns the <code>st-selected</code> class and another to select all the rows, to which we pass our table data and it checks it to see which items have <code>isSelected == true</code></p>

<h6 id="rowselectalljs">rowSelectAll.js</h6>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">rowSelectAll</span><span class="p">()</span> <span class="p">{</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">require</span><span class="o">:</span> <span class="s1">&#39;^stTable&#39;</span><span class="p">,</span>
    <span class="nx">template</span><span class="o">:</span> <span class="s1">&#39;&lt;input type=&quot;checkbox&quot;&gt;&#39;</span><span class="p">,</span>
    <span class="nx">scope</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">all</span><span class="o">:</span> <span class="s1">&#39;=rowSelectAll&#39;</span><span class="p">,</span>
      <span class="nx">selected</span><span class="o">:</span> <span class="s1">&#39;=&#39;</span>
    <span class="p">},</span>
    <span class="nx">link</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>

      <span class="nx">scope</span><span class="p">.</span><span class="nx">isAllSelected</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

      <span class="nx">element</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>

        <span class="nx">scope</span><span class="p">.</span><span class="nx">$apply</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

          <span class="nx">scope</span><span class="p">.</span><span class="nx">all</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>

            <span class="nx">val</span><span class="p">.</span><span class="nx">isSelected</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">isAllSelected</span><span class="p">;</span>

          <span class="p">});</span>

        <span class="p">});</span>

      <span class="p">});</span>

      <span class="nx">scope</span><span class="p">.</span><span class="nx">$watchCollection</span><span class="p">(</span><span class="s1">&#39;selected&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newVal</span><span class="p">)</span> <span class="p">{</span>

        <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">newVal</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">all</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">((</span><span class="nx">s</span> <span class="o">==</span> <span class="nx">a</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">s</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>

          <span class="nx">element</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;checked&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
          <span class="nx">scope</span><span class="p">.</span><span class="nx">isAllSelected</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

          <span class="nx">element</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;checked&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
          <span class="nx">scope</span><span class="p">.</span><span class="nx">isAllSelected</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

        <span class="p">}</span>

      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">}</span>

<span class="nx">angular</span>
  <span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s1">&#39;rowSelectAll&#39;</span><span class="p">,</span> <span class="nx">rowSelectAll</span><span class="p">)</span></code></pre></div>

<h6 id="rowselectjs">rowSelect.js</h6>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">rowSelect</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">require</span><span class="o">:</span> <span class="s1">&#39;^stTable&#39;</span><span class="p">,</span>
    <span class="nx">template</span><span class="o">:</span> <span class="s1">&#39;&lt;input type=&quot;checkbox&quot;&gt;&#39;</span><span class="p">,</span>
    <span class="nx">scope</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">row</span><span class="o">:</span> <span class="s1">&#39;=rowSelect&#39;</span>
    <span class="p">},</span>
    <span class="nx">link</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attr</span><span class="p">,</span> <span class="nx">ctrl</span><span class="p">)</span> <span class="p">{</span>

      <span class="nx">element</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>

        <span class="nx">scope</span><span class="p">.</span><span class="nx">$apply</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

            <span class="nx">ctrl</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">scope</span><span class="p">.</span><span class="nx">row</span><span class="p">,</span> <span class="s1">&#39;multiple&#39;</span><span class="p">);</span>

        <span class="p">});</span>

      <span class="p">});</span>

      <span class="nx">scope</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="s1">&#39;row.isSelected&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">newValue</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">newValue</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>

            <span class="nx">element</span><span class="p">.</span><span class="nx">parent</span><span class="p">().</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;st-selected&#39;</span><span class="p">);</span>
            <span class="nx">element</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;checked&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

            <span class="nx">element</span><span class="p">.</span><span class="nx">parent</span><span class="p">().</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;st-selected&#39;</span><span class="p">);</span>
            <span class="nx">element</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;checked&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>

        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">}</span>

<span class="nx">angular</span>
  <span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s1">&#39;rowSelect&#39;</span><span class="p">,</span> <span class="nx">rowSelect</span><span class="p">)</span></code></pre></div>

<p>Next, in order to get data from the selected rows, I’ve created two functions. <code>selectAll()</code> goes with the <code>rowSelectAll</code> directive and we pass it the entire dataset. <code>select()</code> only needs the <code>row</code> from <code>ng-repeat</code>, being assigned to the single row selection directive.</p>

<h6 id="appjs">app.js</h6>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">MainCtrl</span><span class="p">()</span> <span class="p">{</span> 

  <span class="kd">var</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  
  <span class="c1">// Declare the array for the selected items</span>
  <span class="nx">vm</span><span class="p">.</span><span class="nx">selected</span> <span class="o">=</span> <span class="p">[];</span> 
  
  <span class="c1">// Function to get data for all selected items</span>
  <span class="nx">vm</span><span class="p">.</span><span class="nx">selectAll</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">collection</span><span class="p">)</span> <span class="p">{</span>
    
    <span class="c1">// if there are no items in the &#39;selected&#39; array, </span>
    <span class="c1">// push all elements to &#39;selected&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">vm</span><span class="p">.</span><span class="nx">selected</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      
      <span class="nx">angular</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">collection</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="nx">vm</span><span class="p">.</span><span class="nx">selected</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">val</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span> 
        
      <span class="p">});</span>
      
    <span class="c1">// if there are items in the &#39;selected&#39; array, </span>
    <span class="c1">// add only those that ar not</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">vm</span><span class="p">.</span><span class="nx">selected</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">selected</span><span class="p">.</span><span class="nx">length</span> <span class="o">!=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      
      <span class="nx">angular</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">collection</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="kd">var</span> <span class="nx">found</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">selected</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">val</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
        
        <span class="k">if</span><span class="p">(</span><span class="nx">found</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">selected</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">val</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
        
      <span class="p">});</span>
      
    <span class="c1">// Otherwise, remove all items</span>
    <span class="p">}</span> <span class="k">else</span>  <span class="p">{</span>
      
      <span class="nx">vm</span><span class="p">.</span><span class="nx">selected</span> <span class="o">=</span> <span class="p">[];</span>
      
    <span class="p">}</span>
    
  <span class="p">};</span>
  
  <span class="c1">// Function to get data by selecting a single row</span>
  <span class="nx">vm</span><span class="p">.</span><span class="nx">select</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    
    <span class="kd">var</span> <span class="nx">found</span> <span class="o">=</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">selected</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    
    <span class="k">if</span><span class="p">(</span><span class="nx">found</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">selected</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    
    <span class="k">else</span> <span class="nx">vm</span><span class="p">.</span><span class="nx">selected</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">found</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">angular</span>
  <span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;smart-table&#39;</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MainCtrl&#39;</span><span class="p">,</span> <span class="nx">MainCtrl</span><span class="p">)</span></code></pre></div>

<p>The directives add the <code>st-selected</code> class to every row that is selected, so in order to see the selected row, just style that class.</p>

<h6 id="stylecss">style.css</h6>

<div class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.st-selected</span> <span class="o">&gt;</span> <span class="nt">td</span> <span class="p">{</span>
  <span class="k">background</span><span class="o">:</span> <span class="nb">aliceblue</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<h3 id="see-it-in-action">See it in action</h3>

<iframe width="100%" height="550" src="http://embed.plnkr.co/iIVlfFZpmXrRvc7rLkFf" frameborder="0" allowfullscren="allowfullscren"></iframe>

<p>And that’s it! If you have any questions, let me know in the comments below.</p>

<!--       <div class="social">
        <div class="social__button">
          <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
        </div>
        <div class="social__button">
          <div id="fb-root"></div>
          <div class="fb-like" data-send="false" data-layout="button_count"
          data-width="1" data-show-faces="false" data-action="like"></div>
        </div>
        <div class="social__button">
          <g:plusone size="medium"></g:plusone>
        </div>
      </div> -->
      <div class="disqus">
        <div id="disqus_thread"></div>
      </div>
    </article>

    <script>
      var disqus_url = 'http://razvanbalosin.com/angularjs-smart-table-select-all-rows-directive';
      var disqus_title = 'AngularJS Smart-Table select all rows directive';
      var disqus_shortname = 'razvanbalosin';
      (function() {
        var dsq = document.createElement('script');
        dsq.async = dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        document.getElementsByTagName('head')[0].appendChild(dsq);
      })();
    </script>
      </div>
    </div>

    <script>
      (function(i,s,o,g,r,a,m){i.GoogleAnalyticsObject=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-65724005-1', 'razvanbalosin.com');
      ga('send', 'pageview');
    </script>

  </body>  